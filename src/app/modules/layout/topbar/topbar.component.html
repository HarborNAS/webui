<nav [attr.aria-label]="'Top bar' | translate">
  <mat-toolbar class="topbar backdrop-blur-md !bg-background/10 !text-foreground">
    <mat-toolbar-row>
      <!-- Sidenav toggle button -->
      <button matIconButton class="mat-icon-button" [matMenuTriggerFor]="menu">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 453.42 228.14">
          <g>
            <g>
              <path fill="currentColor" d="M145.57,0h82.57c0,125.8-102.34,228.14-228.14,228.14v-82.57c80.27,0,145.57-65.3,145.57-145.58Z" />
              <path fill="currentColor" d="M307.85,228.14h-82.57C225.28,102.34,327.62,0,453.42,0v82.57c-80.27,0-145.57,65.3-145.57,145.58Z" />
            </g>
          </g>
        </svg>
      </button>
      <mat-menu #menu="matMenu">
        <button mat-menu-item>About TrueNas</button>
        <a mat-menu-item [routerLink]="['/system/general']">System Settings...</a>
      </mat-menu>

      <!-- <ix-global-search-trigger></ix-global-search-trigger> -->
      <ix-truenas-logo [fullSize]="true"></ix-truenas-logo>

      <div class="topbar-mobile-footer" [class.has-console-footer]="hasConsoleFooter$ | async">
        <span
          [matTooltip]="'Send Feedback' | translate"
        >
          <button
            mat-icon-button
            class="topbar-button-right"
            ixTest="leave-feedback"
            [ixUiSearch]="searchableElements.elements.sendFeedback"
            (click)="onFeedbackIndicatorPressed()"
          >
            <ix-icon name="mdi-emoticon"></ix-icon>
          </button>
        </span>

        <ix-truecommand-button></ix-truecommand-button>
        @if (hasTncConfig()) {
          <ix-truenas-connect-button></ix-truenas-connect-button>
        }

        @if (hasRebootRequiredReasons()) {
          <button
            mat-icon-button
            class="topbar-button-right"
            ixTest="reboot-info"
            [matTooltip]="tooltips.rebootInfo | translate"
            (click)="showRebootInfoDialog()"
          >
            <ix-icon class="movement" name="update"></ix-icon>
          </button>
        }

        <!-- finish update -->
        @if (updateIsRunning) {
          <button
            mat-icon-button
            id="update-running"
            class="topbar-button-right"
            ixTest="update-is-running"
            [matTooltip]="tooltips.update | translate"
            (click)="showUpdateDialog()"
          >
            <ix-icon class="movement" name="system_update_alt"></ix-icon>
          </button>
        }
        <ix-checkin-indicator></ix-checkin-indicator>
        <ix-resilvering-indicator></ix-resilvering-indicator>
        <ix-ha-status-icon></ix-ha-status-icon>
        <ix-jobs-indicator></ix-jobs-indicator>

        <!-- Alert toggle button -->
        @let alertBadgeCount = alertBadgeCount$ | async;
        <button
          matBadgeSize="small"
          matBadgeColor="warn"
          mat-icon-button
          class="topbar-button-right"
          ixTest="alerts-indicator"
          [matBadge]="alertBadgeCount"
          [matBadgeHidden]="alertBadgeCount === 0"
          [matTooltip]="tooltips.alerts | translate"
          [ixUiSearch]="searchableElements.elements.alerts"
          (click)="onAlertIndicatorPressed()"
        >
          <ix-icon name="notifications"></ix-icon>
        </button>

        <ix-user-menu></ix-user-menu>
        <ix-power-menu></ix-power-menu>
      </div>
    </mat-toolbar-row>
  </mat-toolbar>
</nav>
